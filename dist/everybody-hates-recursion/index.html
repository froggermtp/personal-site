<!DOCTYPE html><html lang="en"><head>
    
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Everybody Hates Recursion | Matthew Parris</title>
    <meta name="description" content="A tutorial covering recursion and tail call optimization, with code examples written in PHP">
    <meta name="author" content="Matthew Parris">
    <link rel="canonical" href="https://www.matthewparris.org/everybody-hates-recursion/">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸš€</text></svg>">

    

    <style>
        /*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}:root{--space-sm:.25rem;--space-med:.5rem;--space-lg:1rem;--space-xl:2rem;--space-xxl:4rem;--color-dark:hsl(0, 0%, 13%);--color-grey:hsl(0, 0%, 29%);--color-light-grey:hsl(0, 0%, 45%)}*{color:var(--color-dark);font-weight:400;font-family:Oxygen,sans-serif}h1,h2,h3,h4,h5,h6{line-height:1.25;margin:0 var(--space-xl) var(--space-med) var(--space-xl)}p{line-height:1.7em;margin:0 var(--space-xl) var(--space-med) var(--space-xl)}img{display:block;width:100%;max-width:100%;height:auto}section{margin-bottom:var(--space-lg)}.bowlby{font-family:'Bowlby One SC',cursive}.sourceSansPro{font-family:'Source Sans Pro',sans-serif}#main-container{display:flex;flex-flow:column wrap;width:100%;max-width:730px;margin-top:50px;min-height:calc(100vh - 122px);overflow:hidden}#mainNav{position:fixed;top:0;left:0;width:100%;height:50px;box-shadow:0 .125rem .25rem 0 rgba(0,0,0,.11);z-index:2;background:#fff}#navContainer{display:flex;justify-content:space-between;align-items:center}#logo{margin-left:var(--space-xl);width:100%;font-size:18px;letter-spacing:0;font-weight:700;text-decoration:none}#header-buttons{display:none;flex-direction:column;justify-content:inherit;overflow:hidden;width:100%}#header-buttons a{text-decoration:none}.fullscreen #header-buttons{display:flex;margin-left:var(--space-xl)}.fullscreen #logo{display:none}.header-button{background-color:#fff;font-size:20px;font-weight:600;margin:var(--space-med) 0 var(--space-med) var(--space-lg);padding:5px 8px 5px 8px;position:relative}.fullscreen .header-button{padding-left:0;text-align:left}.hamburger-button{display:flex;flex-direction:column;justify-content:center;cursor:pointer;margin-right:var(--space-lg)}.bar1,.bar2,.bar3{width:18px;height:2.5px;background-color:#333;margin:3.5px 0 0 0;transition:.4s}.bar3{margin-bottom:6px}.change .bar1{-webkit-transform:rotate(-45deg) translate(-5px,4px);transform:rotate(-45deg) translate(-5px,4px)}.change .bar2{opacity:0}.change .bar3{-webkit-transform:rotate(45deg) translate(-4px,-4px);transform:rotate(45deg) translate(-4px,-4px)}#nav-header{display:flex;justify-content:flex-end;height:50px;width:100%}#mainNav.fullscreen{height:100%}.fullscreen #navContainer{flex-direction:column-reverse;justify-content:flex-end}#mainNav.fullscreen button{font-size:1.4rem;border:none;margin-left:0}#mainNav.fullscreen button:hover{background-color:inherit;color:initial}#pageFooter{display:flex;flex-direction:column;justify-content:space-around;height:75px;text-align:center}#social{display:flex;justify-content:center;margin-bottom:var(--space-lg)}#social>a+a{margin-left:var(--space-xl)}#social img{height:25px;width:25px}#copyright{margin-bottom:var(--space-lg);color:var(--color-grey)}@media only screen and (min-width:768px){#main-container{width:70%;margin:50px auto 0}#mainNav{justify-content:center}#navContainer{width:70%;max-width:730px;margin:auto}#nav-header{display:none}#header-buttons{display:flex;flex-direction:row;justify-content:flex-end}#home-button{display:none}.header-button{border:none;color:var(--color-light-grey);font-size:16px;font-weight:400}.header-button:hover{background-color:#fff;color:var(--color-black)}}@media only screen and (min-width:920px){#social>a+a{margin-left:var(--space-xxl)}}.small-caps{font-variant:small-caps}.pull-T,.pull-V,.pull-W,.pull-Y{margin-left:-.07em}.push-T,.push-V,.push-W,.push-Y{margin-right:.07em}.pull-C,.pull-O,.pull-c,.pull-o{margin-left:-.04em}.push-C,.push-O,.push-c,.push-o{margin-right:.04em}.pull-A{margin-left:-.03em}.push-A{margin-right:.03em}.pull-single{margin-left:-.27em}.push-single{margin-right:.27em}.pull-double,.pull-single,.push-double,.push-single{display:inline-block}.pull-double{margin-left:-.46em}.push-double{margin-right:.46em}
    </style>

    <link href="https://fonts.googleapis.com/css?family=Oxygen|Source+Sans+Pro&amp;display=swap" rel="stylesheet">

    
    
    <meta property="og:title" content="Everybody Hates Recursion">
    <meta property="og:description" content="A tutorial covering recursion and tail call optimization, with code examples written in PHP">
    <meta property="og:image" content="/img/recursive-hand-painting.jpg&quot;">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Everybody Hates Recursion">
    <meta name="twitter:description" content="A tutorial covering recursion and tail call optimization, with code examples written in PHP">
    <meta name="twitter:image" content="/img/recursive-hand-painting.jpg&quot;">

    

    <style>
        .box{display:flex}.box--split{justify-content:flex-start;margin-bottom:var(--space-lg);align-items:center}.link--share{font-size:1rem;color:var(--color-light-grey);margin-right:var(--space-xl);text-decoration:underline}.link--share:hover{color:var(--color-black)}article{width:100%;margin-bottom:var(--space-xl)}.articleContent>*{margin-left:var(--space-xl);margin-right:var(--space-xl);margin-bottom:var(--space-lg)}.articleContent p{font-size:1em}.articleContent img{width:100%;display:block;margin-left:auto;margin-right:auto}.articleContent blockquote{position:relative}.articleContent blockquote:before{content:'';border-left:4px solid #000;height:100%;width:4px;position:absolute;left:-15px}.articleContent h2{font-weight:700;font-size:1.375em}.articleContent h3{font-weight:700;font-size:1.1em}.articleContent .math{height:2.5rem}.articleContent p>a,.articleContent p>a *{color:#2a5db0}.eleventy-plugin-youtube-embed{margin-left:0;margin-right:0}header{margin-top:var(--space-xl);margin-bottom:var(--space-lg);font-weight:700;font-size:1.5rem}header h1{margin-bottom:var(--space-lg);font-family:'Source Sans Pro',sans-serif;font-size:1.5em}#mainImage{width:100%;max-height:400px;overflow:hidden;margin-bottom:var(--space-xl)}#mainImage img{width:100%}#date{font-size:.9rem;color:var(--color-light-grey);margin-bottom:0}#date *{color:inherit}#otherPosts{display:flex;flex-flow:column;margin-left:var(--space-xl);margin-bottom:var(--space-xl);margin-right:var(--space-xl)}#next{margin-bottom:var(--space-lg)}#next,#previous{display:flex;flex-direction:column}#next span,#previous span{margin-bottom:var(--space-sm)}@media only screen and (min-width:768px){#otherPosts{flex-flow:row;justify-content:space-between}#next,#previous{width:50%}#next{text-align:right;order:1;margin-left:auto}#previous{order:0;margin-right:auto}}
    </style>

</head>

<body>
    <div id="main-container">
        <nav id="mainNav">
    <div id="navContainer">
        <a href="/" id="logo">Matthew Parris</a>
        <div id="header-buttons">
            <a class="header-button" id="home-button" href="/">Home</a>
            <a class="header-button" href="/blog">Blog</a>
            <a class="header-button" href="/about">About Me</a>
        </div>
        <div id="nav-header">
            <div id="mobile-menu-button" class="hamburger-button" tabindex="0">
                <div class="bar1"></div>
                <div class="bar2"></div>
                <div class="bar3"></div>
            </div>
        </div>
    </div>
</nav>


<script>
    const menuButton=document.getElementById("mobile-menu-button");menuButton.addEventListener("click",(function(e){document.querySelector("nav").classList.toggle("fullscreen"),menuButton.classList.toggle("change")})),menuButton.addEventListener("keyup",(function(e){13===e.keyCode&&menuButton.click()}));
</script>
        
    <article>
        <header>
            <div id="mainImage">
                <img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAA0JCgsKCA0LCgsODg0PEyAVExISEyccHhcgLikxMC4pLSwzOko+MzZGNywtQFdBRkxOUlNSMj5aYVpQYEpRUk8BDg4OExETJhUVJk81LTVPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT//AABEIAAcADAMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AMzTdZj0u1iTzf3ixhiCp78/yrHcrRFC6nuNRl+1ROXVxxu6j2p83LoHJfVH/9k=" "="" alt="A painting showing hands painting other hands" data-src="/img/recursive-hand-painting.jpg" class="lazyload" width="1280" height="720">
            </div>
            <h1 id="title">Everybody Hates Recursion</h1>
            <div class="box box--split js-share">
                <p id="date">Originally written: <time>July 11, 2020</time></p>
            </div>
        </header>
        <div class="articleContent">
            <p>Everybody hates reÂ­curÂ­sion. Well, maybe I'm exÂ­agÂ­gerÂ­atÂ­ing but the techÂ­nique is ofÂ­ten disÂ­missed as useÂ­less and comÂ­pliÂ­cated. You may be thinkÂ­ing:<span class="push-double"></span> <span class="pull-double">â€œ</span>I'll just keep my loops please.â€ And there's nothÂ­ing wrong with that. In many sitÂ­uÂ­aÂ­tions, loops or higher-orÂ­der funcÂ­tions are the natÂ­ural soÂ­luÂ­tion. Not to menÂ­tion, some lanÂ­guages have poor supÂ­port for reÂ­curÂ­sionâ€”but I'll dive into that part later.</p>
<h2>But Why?</h2>
<p>So, why should you even bother with the esÂ­oÂ­teric techÂ­nique? I'll list a few reaÂ­sons. For one, some probÂ­lems can easÂ­ily be exÂ­pressed reÂ­curÂ­sivelyâ€”the <a href="https://en.wikipedia.org/wiki/Tower_of_Hanoi">Tower of Hanoi</a> puzÂ­zle quickly comes to mind. Second, some proÂ­gramÂ­ming lanÂ­guages emÂ­phaÂ­size reÂ­curÂ­sion as a key lanÂ­guage feaÂ­ture. This is true for many funcÂ­tional proÂ­gramÂ­ming lanÂ­guages. For exÂ­amÂ­ple, it is one of the things that tripped me up when learnÂ­ing <a href="https://racket-lang.org/">Racket</a>, a modÂ­ern imÂ­pleÂ­menÂ­taÂ­tion of Scheme. The lanÂ­guage has no loopÂ­ing conÂ­structs, so you're ofÂ­ten forced into usÂ­ing reÂ­curÂ­sion. Finally, I think it's good to learn new things. Why stay stagÂ­nant? The world is worth exÂ­plorÂ­ing.</p>
<h2>Explain It Please</h2>
<p>To solve a probÂ­lem usÂ­ing reÂ­curÂ­sion, it must take on a patÂ­tern, which I'll deÂ­scribe here. For one, the techÂ­nique asÂ­sumes that the probÂ­lem can be broÂ­ken down into smaller verÂ­sions of the same probÂ­lem. At some point, the breakÂ­down process can no longer conÂ­tinue beÂ­cause an axÂ­iomatic form of the probÂ­lem is reached. We'll call this fully simÂ­pliÂ­ï¬ed form a base case. These base casesâ€”there can be more than oneâ€”are hardÂ­coded by the proÂ­gramÂ­mer. Every reÂ­curÂ­sive funcÂ­tion needs at least one base case. Otherwise, it's as if you wrote an inÂ­ï¬Â­nite loop. Of course, you also need a self callâ€”i.e., you call the funcÂ­tion within the same funcÂ­tion's body. Usually, the self call will grapÂ­ple with a reÂ­duced verÂ­sion of the probÂ­lemâ€”this should obÂ­viÂ­ously tie into the work on a smaller probÂ­lem idea. Once the reÂ­curÂ­sive funcÂ­tion is called with a state corÂ­reÂ­spondÂ­ing to a base case, the funcÂ­tion reÂ­turns some speÂ­cial value, and the chain of funcÂ­tion calls is ï¬Â­nitely capped.</p>
<h2>Factorials</h2>
<p>I am goÂ­ing to inÂ­terÂ­rupt our train of thought to inÂ­ject an exÂ­amÂ­ple. So, letâ€™s stare at this code repÂ­reÂ­sentÂ­ing the <a href="https://en.wikipedia.org/wiki/Factorial">facÂ­toÂ­rÂ­ial funcÂ­tion</a>. For conÂ­tinÂ­gency reaÂ­sons, in case your highÂ­school math teacher failed you, Iâ€™ll exÂ­plain this suÂ­per quick. Say we want to comÂ­pute one facÂ­toÂ­rÂ­ial. Well, thatâ€™s just oneâ€“and hint, itâ€™s one of the base cases. But what if you want to comÂ­pute 2 facÂ­toÂ­rÂ­ial. Then, you simÂ­ply take 2 * 1. Following the patÂ­tern, three facÂ­toÂ­rÂ­ial is 3 * 2 * 1. Yeah, there's not much to this. The forÂ­mal deÂ­fÂ­iÂ­nÂ­iÂ­tion is that the facÂ­toÂ­rÂ­ial of a posÂ­iÂ­tive inÂ­teÂ­ger <em>n</em>, deÂ­noted by <em>n!</em>, is the prodÂ­uct of all posÂ­iÂ­tive inÂ­teÂ­gers less than or equal to <em>n</em>. As an aside, we ranÂ­domly asÂ­sign that zero facÂ­toÂ­rÂ­ial is equal to oneâ€“this is the other base case. Ok, some code stuff.</p>
<script src="https://gist.github.com/froggermtp/831585008fcef792e71420a8b9345e9b.js"></script>
<p>Hopefully, the base case and the self call are obÂ­viÂ­ous. If you're conÂ­fused about how the code works, I recÂ­omÂ­mend getÂ­ting out a sheet of paÂ­per and tracÂ­ing out what hapÂ­pens for difÂ­ferÂ­ent inÂ­puts. Also, please note that the $n paÂ­raÂ­meÂ­ter must be greater than zero. Otherwise, everyÂ­thing will break beÂ­cause the facÂ­toÂ­rÂ­ial seÂ­quence is only deÂ­ï¬ned for posÂ­iÂ­tive valÂ­ues and zero.</p>
<h2>The Call Stack</h2>
<p>It's imÂ­porÂ­tant to note that each time a funcÂ­tion is called, inÂ­forÂ­maÂ­tion about it must be pushed onto the <a href="https://en.wikipedia.org/wiki/Call_stack">call stack</a>. For the uniniÂ­tiÂ­ated, I'll brieï¬‚y exÂ­plain this process. To start, there's nothÂ­ing speÂ­cial about this <a href="https://en.wikipedia.org/wiki/Stack_(abstract_data_type)">stack</a>â€“we are still pushÂ­ing and popÂ­ping. In this case, we are pushÂ­ing frames onto the stack that conÂ­tain inÂ­forÂ­maÂ­tion about the funcÂ­tion such as its paÂ­raÂ­meÂ­ters, its loÂ­cal variÂ­ables, and a reÂ­turn adÂ­dress.<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> The call stack's imÂ­pleÂ­menÂ­taÂ­tion is lanÂ­guage and maÂ­chine speÂ­ciï¬c so let's not get lost in the deÂ­tails. Basically, frames are pushed and then popped from the call stack as funcÂ­tions beÂ­gin and end exÂ­eÂ­cuÂ­tion reÂ­specÂ­tively. Cool, but why do we care? Well, these frames take up memÂ­oryâ€”and the comÂ­puter only has a ï¬Â­nite amount of memÂ­ory. Therefore, there is goÂ­ing to be some hard cap on the numÂ­ber funcÂ­tion calls that can be nested. If the comÂ­puter runs out space for a new frame, then a stack overÂ­ï¬‚ow erÂ­ror will be thrown by most lanÂ­guages. Usually, reÂ­curÂ­sive funcÂ­tions are prone to these types of erÂ­rorsâ€”not beÂ­cause the proÂ­gramÂ­mer made a misÂ­takeâ€”but due to the natÂ­ural limÂ­iÂ­taÂ­tions of nestÂ­ing large amounts of funcÂ­tion calls.</p>
<h2>Tail Call Optimization</h2>
<p>While many peoÂ­ple simÂ­ply hate reÂ­curÂ­sion due to perÂ­sonal prefÂ­erÂ­ences, there are times where usÂ­ing the techÂ­nique is a bad idea. As I just menÂ­tioned, inÂ­forÂ­maÂ­tion about funcÂ­tion calls has to be pushed onto the call stack, which takes up memÂ­ory. Many lanÂ­guages have arÂ­biÂ­trary limÂ­its on the depth of the call stack. For exÂ­amÂ­ple, <a href="https://www.geeksforgeeks.org/python-handling-recursion-limit/">Python sets its limit at about 1000 beÂ­fore trigÂ­gerÂ­ing a stack overÂ­ï¬‚ow</a>. Thus, memÂ­ory usÂ­age is a huge isÂ­sue when usÂ­ing reÂ­curÂ­sion. In conÂ­trast, itÂ­erÂ­aÂ­tive techÂ­niques, such as for loops, don't have this probÂ­lem beÂ­cause they only reÂ­quire a conÂ­stant amount of memÂ­ory reÂ­gardÂ­less of the numÂ­ber of repÂ­eÂ­tiÂ­tions. But don't worry about this sad news. Some lanÂ­guages imÂ­pleÂ­ment an idea called tail call opÂ­tiÂ­mizaÂ­tion that can save us.</p>
<p>Assuming the lanÂ­guage has tail call opÂ­tiÂ­mizaÂ­tion, a tail reÂ­curÂ­sive funcÂ­tion will only take up conÂ­stant space on the call stack. Although simÂ­ple, the conÂ­cept seems to conÂ­fuse many peoÂ­ple. The self call has to be the last opÂ­erÂ­aÂ­tion of the funcÂ­tion. Importantly, this does not mean the last line. For an exÂ­amÂ­ple, reÂ­view the facÂ­toÂ­rÂ­ial funcÂ­tion from earÂ­lier. The last opÂ­erÂ­aÂ­tion is the mulÂ­tiÂ­pliÂ­caÂ­tion, not the funcÂ­tion call.</p>
<p>To conÂ­vert our facÂ­toÂ­rÂ­ial funcÂ­tion to be tail reÂ­curÂ­sive, a few changes have to be made. Importantlyâ€“and this is worth reÂ­peatÂ­ingâ€“the self call has to be the last opÂ­erÂ­aÂ­tion. To pull this off, it turns out an exÂ­tra paÂ­raÂ­meÂ­ter has to added to track the acÂ­cuÂ­muÂ­lated changes to the anÂ­swer. Let's just look at the code.</p>
<script src="https://gist.github.com/froggermtp/56b8690b39c517ac0fff043a3e996088.js"></script>
<h2>Proving the Constant Space Hypothesis</h2>
<p>So what makes tail reÂ­curÂ­sive funcÂ­tions noteÂ­worÂ­thy? After all, like all funcÂ­tions, they must be alÂ­loÂ­cated on the call stack.<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> Yet, someÂ­thing speÂ­cial hapÂ­pens when nestÂ­ing these types of funcÂ­tions: the ï¬Â­nal nested funcÂ­tion callâ€™s reÂ­turn value will be the ï¬Â­nal anÂ­swer. To prove I'm not makÂ­ing stuff up, study the folÂ­lowÂ­ing diÂ­aÂ­gram of a call stack for the tail reÂ­curÂ­sive facÂ­toÂ­rÂ­ial funcÂ­tion.</p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAZCAYAAAA4/K6pAAAACXBIWXMAAAsTAAALEwEAmpwYAAADXUlEQVQ4y5VVaUscQRDt3xdxEwlIAoGQ36WBqLBIzPFBQcEvghGPlVUxa/ZQ12Ov2WvumT2crrzX62w25FMaHtNdVV1VXfW2VpVKJXl8fJRutyudTue/oR4eHswmDAPxfV+CIJiC5xSz8hRhGIpi5F6vZ4z6/f5UORgMJIDMcWwTwHFdcyGKIonjWMbjsXCpdrutCRhqGGrPc7XnuhqGE1m3o+uNuu72etB5GoE0AmgE0EmSaMXotm3DcyguopgIACNQBofS7XXx9SRCZGY2HA4FlycZNJvNyHGcCBciKKLRaDQFzvFgOIhx6R9dCnVzc5NtNBpZRM8iEwM4zKI263jaZwJZrlOW6mehjo6OMufn5xm0M1MsFomX19fX8wcHB4ubm5vvCe4po+7ZxoB31O7ubmZ/fz9zenqaOTk5Mcjn8/M7OzuL2Wz2PcE9Zal+ilwuo6rV6krLslZQpBU8g1hFpT9ZlrUO3Xei1WqtU0bdxGZqu6Lu7+8jtC/iQp+nQKtiXDLAOZ6RA7758qzuqrfStixDpJQko9HQMBOFkx7I5YNY8SA27Y0MQhmglcPRSFSlXEpqtVoCFiZ4RuL5foLLiWPbSbtt6UazqeEkQQDoXWPjuk4Cp0kQhonJwLJa4vnexDszgPcQUW27L53uhETMLDJUnmTCDAgFDgyR6hBEQkajKbhAIAOuVD6esSFIpA2wcQMV3QAxDOBwA+T5iuJ+I/C8L5Sl+lk7lcvlFi4vLxfgaKFSqRigda+Oj4/fbG9vfyCwf0sZdSDUX1Agydze3t4cGDl3eHhoAKcvtra2Xq+urr4juKcs1c+CRFoGUZZRqGWkRHxExZcgW7u9vf1M4Ilr0C9Rh6cuz4JECvDOAB0IuEAOwGwxT/yQ+CMPU3mQLnV/VxX84iZkQav4W396GmMfYT440seswE0zBygz7XwmHKGuK2Vdr9c0qqr9wNeIogdxbKYSJ1Wz2dJwYqaQ708mEicTz/yqMqZyrYapjMnEuecZSocmOpgocGBmJs8kFucm6W3bjoEq/Pwpd9Uq2GgJCmfAJxH1el04tWv4Np/ltOO30+Ew7os6+LEv52dnUiz+ksLVlVxdFaRULkulUhbwQ/JneTm7uJBCoQBZRfg/gv4LuiMP+D/5DScTjoGU5751AAAAAElFTkSuQmCC" style="max-width:193px" data-src="/img/factorial_tail_call_stack.svg" class="lazyload">
<p>From the diÂ­aÂ­gram, it's obÂ­viÂ­ous that the ï¬Â­nal frame will have a reÂ­turn value of six, the ï¬Â­nal anÂ­swer. If we bothÂ­ered to mainÂ­tain all the frames and bubÂ­ble the value back down, then the six would get funÂ­neled straight through. Thus, there is no point in keepÂ­ing the early frames. We can safely disÂ­card them.</p>
<p>Now, let's imagÂ­ine a bad sitÂ­uÂ­aÂ­tion. If the funcÂ­tion isn't tail reÂ­curÂ­sive, then you'll have to store all the frames and backÂ­subÂ­stiÂ­tute to get the anÂ­swer. We can't preÂ­maÂ­turely pop off the early frames beÂ­cause we need inÂ­forÂ­maÂ­tion from later calls to comÂ­plete the last opÂ­erÂ­aÂ­tion. Try getÂ­ting out a piece of paÂ­per and tracÂ­ing the non-tail reÂ­curÂ­sive facÂ­toÂ­rÂ­ial funcÂ­tion to see why this is the case.</p>
<p>Now, disÂ­apÂ­pointÂ­ingly perÂ­haps, a lot of proÂ­gramÂ­ming lanÂ­guages do not imÂ­pleÂ­ment tail call opÂ­tiÂ­mizaÂ­tionâ€“and this inÂ­cludes most imÂ­perÂ­aÂ­tive lanÂ­guages. In most cases, you can ï¬nd out if a lanÂ­guage has tail call opÂ­tiÂ­mizaÂ­tion with a Google search. Alternatively, I guess you could exÂ­eÂ­cute a deeply nested reÂ­curÂ­sive funcÂ­tion and see if you get a stack overÂ­ï¬‚ow erÂ­ror.</p>
<h2>Conclusion</h2>
<p>Thanks for readÂ­ing my ramÂ­blings about reÂ­curÂ­sion. On one level, itâ€™s not so hard. Your funcÂ­tion only needs three propÂ­erÂ­ties to be reÂ­curÂ­sive and useÂ­ful: it must have at least one base case, it must call itÂ­self, and the inÂ­put must be reÂ­duced for each subÂ­seÂ­quent self call. They are a great way to solve probÂ­lems that built from smaller idenÂ­tiÂ­cal subÂ­probÂ­lems. Yet, I wouldn't force the techÂ­nique when it's not needed. Without tail call opÂ­tiÂ­mizaÂ­tion, reÂ­curÂ­sion is way less powÂ­erÂ­ful. In fact, I would recÂ­omÂ­mend exÂ­perÂ­iÂ­mentÂ­ing with reÂ­cuÂ­sion usÂ­ing a funcÂ­tional proÂ­gramÂ­ming lanÂ­guage. These lanÂ­guages are built around funcÂ­tion calls and are ofÂ­ten deÂ­penÂ­dent on reÂ­curÂ­sion for doÂ­ing itÂ­erÂ­aÂ­tion. Anyway, I hope this guide inÂ­spires you to play around with this conÂ­cept.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>To note, the reÂ­turn adÂ­dress is like a bookÂ­mark that desÂ­igÂ­nates to the comÂ­puter where to jump back to afÂ­ter the funcÂ­tion call ends. <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>Ok, so in real life, there are mulÂ­tiÂ­ple difÂ­ferÂ­ent ways to imÂ­pleÂ­ment tail call opÂ­tiÂ­mizaÂ­tion. The proÂ­gramÂ­ming lanÂ­guage isn't necÂ­esÂ­sarÂ­ily preÂ­maÂ­turely dropÂ­ping stack frames. Yet, the ideas I show here give an inÂ­tuÂ­ition about why we can even atÂ­tempt the opÂ­tiÂ­mizaÂ­tion. <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>

        </div>
    </article>

    <nav id="otherPosts">
    
        <div id="next">
            <span>Next post</span>
            <a href="/the-tower-of-hanoi/">The Tower of Hanoi</a>
        </div>
    
    
        <div id="previous">
            <span>Previous post</span>
            <a href="/summary-of-eating-meat-evolution-patterns-and-consequences/">Eating Meat: Evolution, Patterns, and Consequences</a>
        </div>
    
    </nav>
    

    <script>
        var matthewShare=function(t,e){"use strict";return{attemptToAddShareButton:function(){if(!navigator.share)return;e.querySelector(".js-share").insertAdjacentHTML("beforeend",'\n            <a href="javascript:matthewShare.doSharing()" class="link link--share">Share</a>\n        ')},doSharing:function(){navigator.share({title:e.querySelector("title").textContent,text:e.querySelector('meta[name="description"]').getAttribute("content"),url:e.querySelector('link[rel="canonical"]').getAttribute("href")})}}}(window,document);matthewShare.attemptToAddShareButton();
    </script>

    </div>
    <footer id="pageFooter">
    <div id="social">
            <a href="javascript:decryptEmail('bWF0dGhld3BhcnJpc0BvdXRsb29rLmNvbQ==')">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAACXBIWXMAAAsTAAALEwEAmpwYAAAChklEQVRIx93W72tOYRzH8fMXeKCEtD3yZOWBRPmRJ2zMb3dsfsy0mWaGGkpSJCkZSa1tbLT8CC1s4QHRrZSIJvkRYdoa9oSJu+1sbmbv7/qcdXZ27iEnD6xerZ37uq/vdX2v7/c6c5z/6WcERmEc0pEWkXTNOcaCZCALhdgWsXWIeUEWYx8acAf3/pLN0Yj9WGNBJmEutuIi3sBFb8DPFILjXM1xCduxyIKsxxIFspTV4gm+4scvAgUDJPAUJ5Uqm3O2BbmBahTrYS7KcRcfhwnkf2ZjOnAfR7BC52yBDjra3ltcRhmysQC7tIAP+B6yao991o5b2KP02GK3oB7PHA1MauBN7MZ8ZGqgBW9BT0iAb2jVIdsC5+i7tsDreK8xg7b8SdVxSKU3S+d0Ci/Q6RvfqWenUaTcx5QeL9VeBobk1w7vgVYzBeNVGEfxEJ/xBU2o0MQ2ZjJ26lwSgTmHBLEzeqT8TlP3TlCgvSrNBvVVTJ/ZmKlKdVNICwz6oxsvUYMcpcCqrQALVRSrkYd5OuQCVZONXY5jSmN3WBA72Neowyod/CacxzUcxjJMlJhK/SouYLPKdqX65JUv0EAAK+OzWKsAJbiiEk6oQWsUuFQrfqymbVewEu0oH2fQrLkHyrBe3Z+l33bFtPkqxNVObyOulbq+Xnmn8/LmKNIO7YpxnitAqerccnxOvZEMnFlSE7taXPCzFqW3UA25EScsyAG1f7ZuzDpF70nR4anuLa85m9VX+QrUf9VPxwxVzfGQyviTIMEKzVOv9VeKlWml7pmu37zih7uRu3QMVUq/MxMbtIt4BC8sT1y72eGoq5fqqo/69VuslDkjMVov/bSI2Zxj/8m/Q32oNl663RZb4AAAAABJRU5ErkJggg==" alt="Email" data-src="/img/email.svg" class="lazyload">
            </a>
            <a href="https://github.com/froggermtp">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAACXBIWXMAAAsTAAALEwEAmpwYAAADN0lEQVRIx53WeWjPcRzH8e/m14ZmpmaRQo6cuS1nQtjcuUIxt9xnIn8IOctRZnMfRUMZQ1jWzMi1/GFkLGqTmNvYz2yz8Xqv509fs2nbtx7tu+8+3/f7+/l83p/PZ45T8eWRYGkhQ2WF7JNTiJXlEinNaetxKnn5SRDBI2Sh7JYzkiL3kcKzXbSJIFkQMSq8akio9JIFckiS5Ym8lLfyAXafzd+SaTufd0OJVW6ChjJYNkkSgb1S4vIL7mde2l7j3cHE+iuRv4TR5R2Sxpd+lwIp/k+SYtp4eSeNGBHE9PclqSv9ZJs8kCx5KLflkbyTr5Irn5HLMwucTtt0emQxthPTCsIJkHayUlLlPQkOymrZKMclXk7LMX63+7Pcr5c1ckQeM2epxOxsSerLWImTHMljbBdJV4yUSTJOhslw7ifKCOki3WUZVecllsWcbUl6yzrK8gdDcFGm8gEeyjJE6tDzAO5D+JuHiZ4hV+Qbse7JAUuylMWVxUTa+J+U0cxVZa969O4Uw1VCTBu20rG1ivgohZLBpPWUwCokqSl9ZadkShHJ7L60Il4xjl7G1BZiU6fql634JXKL8veS6E95FlKWvvkIq0YS97z4Yloy5ws3P0lySaKkQTWSNJKZcpUkRRSA85pEBSS7KYulWTWStGRnviP5xLQl4dyVF5Sdde+pa+IDqpAg0DXxz+mFxXzjcC6ksD1Y2X2SyzKP7T6wkpXVigWcyMiUENO2JWcK23QGW4r15AbPbNgGShsWZmCZLw9jSxrEaj/L2igkSSYf7LSngW3tz+hVglyQ8xIjcyXct9lx2WrvwRlio3GdzbGABHmcM1sdXrT9P5rVmcBJGEOiJOZoCIF9lx1ME+QEwfOYhxJ+2rzslTG+w6qJTGP12xftl1Wc6xuofdsEa7mS2J41Wc5RSe7zJYfnUe4qtZc7EjSesd0ic1iY/aVxmbPbw1fGuZIUMdmJ7IkdynxY6a4aTqKjDEM058l4aV3OPxyjaJePbHYMWyvdiPnPS8EcMnYG7KHLVh1rpU85pRvJuGeyAA/LLOlEAr+K/h2qLW1lOqdjMkM3oJz2Vt6bKY5YlkNrYvy5fgNFPQkUcCkgcQAAAABJRU5ErkJggg==" alt="Github logo" data-src="/img/github.svg" class="lazyload">
            </a>
            <a href="https://twitter.com/froggermtp">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAACXBIWXMAAAsTAAALEwEAmpwYAAACvElEQVRIx83WaYhNYRzH8TPGnRkMY65l7MsM5Y0tpBSyC82Yxs5IyZLU8EJSSpnilcJkKUaNZMmaIomGNKXwChEmW7mJsV2ua6zf//Q7Ok7n3DvzzlOfTvd0z/k/z//5P89zHOc/bxnIRh66oBPaITPsz5nSqpkBInrxcMzCYszDeBSho4LnK7iTgx7ohwJkpQnQGn318i2owTmcxG6sRQmmYyLG2EOd9aMcxeivnoa1Ar1kL+4ghg9owBNcxREF3IhFjnq1CodwEEsxCLkB6bOUjsY2PEASvzx+4pMC38UxbLYHCxWxDo9xCusxTmnM8UymBV6A0/jiC+D1A89wGCvtwV5Yg1r14hWua7grMAEDNIE26gpc8730t89n3NaIZzqqgBLlMaaH4hrVJeV+kwJaZ6pxP02QdyqGcmWjqdSmYJfynPA8bD16gVu4jIua7NchAdx7L3EAU5XipuqarUmv9wXx5zkp39MEqVe6x6KNW5ILcVQ9+BoSJOhlYfetsioxROvK6YDJ2KM6b0yT73Ts+RtYp0LJcFdwH8z3TOpHpaclQdxOvcUJzFFR/W3ZGtoGlXKDJ+8tCWAdu4ftGKU19k+zApiruYmlmNxUQaxzZ7EE3dxUeVueSq4KD0MKIFWAhBagbZojgkbhbt+F2jaqtKqfamGGBXHvf8MjLVzbfaNBo/DOje3CpdipRfg+IIh3dElVZY2Kp7dbtt6WrwPI9rCBmjAbzQ7c9AXxi6saq7WlF4WdRz0xGDO0N1WqV3UqgMaAlye0cGvVmVJlIPTAsxGMVE+s9M5oAp9ro4tr3bzRPVvNV7QNVejI7Z7moHPaajHa+bEcW7Efx3EeF3S13/s00tWYpvTmhn08+D8kslTCFmwYJqFMW/UyXct0TA/V6NsHTXBzP3Mi+rSJqiC66hrV/Uiq8gxqfwDVzC0nQ9iEnwAAAABJRU5ErkJggg==" alt="Twitter logo" data-src="/img/twitter.svg" class="lazyload">
            </a>
            <a href="https://www.linkedin.com/in/matthew-parris/">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAACXBIWXMAAAsTAAALEwEAmpwYAAACdUlEQVRIx83WS0hUURzH8WtFDxRaBWVlBEVQ1EJs50YUpH1BSkZRaQ30INJFyzbtRMFXTyiFInqAZRBNVgYZlBT5qKRFJEIZBTnFHcdx7Hvidy636d6YZlq0+MDM/55z/uee8z/3XsdxnBPoxhhm/7H3eOwowQt8Rkpso1RALBO2jxnzraM7+IK4LkzhG2KKzWSRyLY3/SedtKAZfBQPcA8j+JpDEssLmjt4g04cRQRnMYhEDkvmJZnV8vTiCDZiDerQozvMpQC8H2bt7qAWq7EENbgRkCSsIMLi3kUXQ+jAXuxAMwa0gWGDzfikAvySJKmSe4aruIQnmNC1hCbiav+mtMTm+jg+6v/0n5Ik1LgPF3BGFfZO8X5cUfIo7uOW7rwJ7fr/WssbuPFmhs/Rgt3YhkadWBNvw07FTeUdwi5UoBTl2KPJDWm8wOq6q41fgXxt/DXFD2AZFmI5VqEQCzBXlqJay/0pLElUZbsSBZr5dcUjGnQOFmMDKrEFmxSbh804qTOXTC/hTJM4OkM12o9T2If1SrIODXiq4sgqSR7K0IoPcl53tEhn7KAK6Hu2Scxst+KyZhrXga1WnyLtX6/vEP91kvnYroJI6lzcVNsC9a1Tn1i2SUw1VSn+/ybJ5JwELVe32uarb636/JbEVMIjlV8J1upU31alHEexqieieFLMgIfVp0Rj9AVtfFxvwouo9720BhTvwjHsx2nF7dPXfCOcU596jTHie3p7SexTeBgPtaaDerqa+Ctf/KXi9rExobZRtRlWH+/EjykQ1/q6vg8JV7FpXU+P2yS2X0xtXF+fnx8S/fpsmczhHR72/jdjjv8AmvTOUK+NQ6IAAAAASUVORK5CYII=" alt="LinkedIn logo" data-src="/img/linkedin.svg" class="lazyload">
            </a>
        </div>
    <div id="copyright">Copyright Â© 2020 Matthew Parris</div>
</footer>


<script>
    function decryptEmail(o){var a=atob(o);window.location.href="mailto:"+a}
</script>


<script>
            (function (selector, src, preferNativeLazyLoad) {
  var images = document.querySelectorAll(selector);
  var numImages = images.length;

  if (numImages > 0) {
    if (preferNativeLazyLoad && 'loading' in HTMLImageElement.prototype) {
      for (var i = 0; i < numImages; i++) {
        var keys = ['src', 'srcset'];

        for (var j = 0; j < keys.length; j++) {
          if (images[i].hasAttribute('data-' + keys[j])) {
            var value = images[i].getAttribute('data-' + keys[j]);
            images[i].setAttribute(keys[j], value);
          }
        }
      }

      return;
    }

    var script = document.createElement('script');
    script.async = true;
    script.src = src;
    document.body.appendChild(script);
  }
})(
              'img',
              'https://cdn.jsdelivr.net/npm/lazysizes@5/lazysizes.min.js',
              false
            );
          </script></body></html>